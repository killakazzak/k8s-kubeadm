sudo apt-get update && sudo apt-get upgrade -y
sudo apt-get install wireguard
sudo nano /etc/sysctl.conf
net.ipv4.ip_forward=1
sudo sysctl -p
net.ipv4.ip_forward=1
sudo apt install ufw
sudo ufw allow ssh
sudo ufw allow 51820/udp
sudo ufw enable
sudo ufw status

Generating private and public keys

cd /etc/wireguard
umask 077
wg genkey | tee privatekey | wg pubkey > publickey

Generate server config
sudo nano /etc/wireguard/wg0.conf

```
[Interface]
PrivateKey = <contents-of-server-privatekey>
Address = 10.0.0.1/24
PostUp = iptables -A FORWARD -i wg0 -j ACCEPT; iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
PostDown = iptables -D FORWARD -i wg0 -j ACCEPT; iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE
ListenPort = 51820

[Peer]
PublicKey = <contents-of-client-publickey>
AllowedIPs = 10.0.0.2/32
```

ip route list default

sudo cat /etc/wireguard/publickey
sudo cat /etc/wireguard/privatekey

Starting WireGuard and enabling it at boot

wg-quick up wg0

wg show

systemctl enable wg-quick@wg0

sudo modprobe wireguard

sudo reboot

Client configuration


sudo nano /etc/wireguard/wg0.conf

```
[Interface]
Address = 10.0.0.2/32
PrivateKey = <contents-of-client-privatekey>
DNS = 1.1.1.1

[Peer]
PublicKey = <contents-of-server-publickey>
Endpoint = <server-public-ip>:51820
AllowedIPs = 0.0.0.0/0, ::/0
```

sudo wg-quick up wg0

sudo systemctl start wg-quick@wg0

sudo wg-quick down wg0
sudo systemctl stop wg-quick@wg0

Adding more clients

sudo nano /etc/wireguard/wg0.conf

[comment]: # (Add the following entry at the end of the file to include your second clientâ€™s public key and set the IP address.)
```
[Peer]
PublicKey = <content-of-client2-publickey>
AllowedIPs = 10.0.0.3/32
```

sudo systemctl restart wg-quick@wg0

